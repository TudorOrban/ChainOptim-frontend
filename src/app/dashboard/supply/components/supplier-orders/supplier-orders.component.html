<div>
    <app-table-toolbar
        [title]="'Supplier Orders'" [searchPlaceholder]="'Search by company ID'" [sortOptions]="sortOptions"
        [selectedItemIds]="selectedOrderIds" [newRawItems]="newRawOrders"
        (onSearch)="handleSearch($event)" (onSortChange)="handleSortChange($event)" (onRefresh)="handleRefresh()" (onCancel)="handleCancel()" (onAddItem)="handleAddOrder()" (onCreateItems)="handleCreateOrders()"
    ></app-table-toolbar>
</div>

<div class="table-container">
    <table class="custom-table">
        <thead>
            <tr>
                <th class="select-col"><input type="checkbox" (change)="toggleAllSelections($event)"/></th> <!-- Header Checkbox -->
                <th class="id-col">ID</th>
                <th class="supplier-id-col">Supplier ID</th>
                <th class="component-col">Component</th>
                <th class="quantity-col">Quantity</th>
                <th class="delivered-col">Delivered Quantity</th>
                <th class="order-date-col">Order Date</th>
                <th class="est-delivery-col">Estimated Delivery Date</th>
                <th class="delivery-date-col">Delivery Date</th>
                <th class="company-id-col">Company ID</th>
                <th class="status-col">Status</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let newOrder of newRawOrders; let i = index">
                <td><input type="checkbox" [(ngModel)]="newOrder.selected"></td>
                <td>{{ i + 1 }}</td>
                <td>
                    <!-- Dropdown for selecting supplier -->
                    <select [(ngModel)]="newOrder.supplierId" name="supplierId-{{ i }}">
                        <option *ngFor="let supplier of suppliers" [value]="supplier.id">
                            {{ supplier.name }}
                        </option>
                    </select>
                </td>
                <td>
                    <!-- Dropdown for selecting component -->
                    <select [(ngModel)]="newOrder.componentId" name="componentId-{{ i }}">
                        <option *ngFor="let component of components" [value]="component.id">
                            {{ component.name }}
                        </option>
                    </select>
                </td>
                <td><input type="number" [(ngModel)]="newOrder.quantity"></td>
                <td><input type="number" [(ngModel)]="newOrder.deliveredQuantity"></td>
                <td><input type="date" [(ngModel)]="newOrder.orderDate"></td>
                <td><input type="date" [(ngModel)]="newOrder.estimatedDeliveryDate"></td>
                <td><input type="date" [(ngModel)]="newOrder.deliveryDate"></td>
                <td><input type="text" [(ngModel)]="newOrder.companyId"></td>
                <td>
                    <!-- Dropdown for selecting order status -->
                    <select [(ngModel)]="newOrder.status" name="status-{{ i }}">
                        <option *ngFor="let status of OrderStatus | keyvalue" [value]="status.value">
                            {{ status.value }}
                        </option>
                    </select>
                </td>
            </tr>
            <tr *ngFor="let order of supplierOrders?.results; let i = index">
                <td><input type="checkbox" [checked]="order?.selected" (change)="toggleSelection(order)" /></td> <!-- Row-specific Checkbox -->
                <td>{{ order.id }}</td>
                <td>{{ getSupplierName(order.supplierId) }}</td>
                <td>{{ order?.component?.name }}</td>
                <td>{{ order?.quantity }}</td>
                <td>{{ order?.deliveredQuantity }}</td>
                <td>{{ order?.orderDate | date:'shortDate' }}</td>
                <td>{{ order?.estimatedDeliveryDate | date:'shortDate' }}</td>
                <td>{{ order?.deliveryDate | date:'shortDate' }}</td>
                <td>{{ order?.companyId }}</td>
                <td>{{ decapitalize(order?.status?.toString()) }}</td>
            </tr>
        </tbody>
    </table>
    

</div>